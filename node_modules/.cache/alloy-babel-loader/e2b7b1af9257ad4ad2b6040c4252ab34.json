{"remainingRequest":"/Users/ssaddique/Axway/KitchenSink-v2-update/kitchensink-v2/node_modules/babel-loader/lib/index.js??ref--4-1!/Users/ssaddique/Axway/KitchenSink-v2-update/kitchensink-v2/node_modules/alloy-loader/lib/index.js??ref--4-2!/Users/ssaddique/Axway/KitchenSink-v2-update/kitchensink-v2/node_modules/alloy/Alloy/lib/alloy/sync/localStorage.js","dependencies":[{"path":"/Users/ssaddique/Axway/KitchenSink-v2-update/kitchensink-v2/node_modules/alloy/Alloy/lib/alloy/sync/localStorage.js","mtime":499162500000},{"path":"/Users/ssaddique/Axway/KitchenSink-v2-update/kitchensink-v2/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/ssaddique/Axway/KitchenSink-v2-update/kitchensink-v2/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/ssaddique/Axway/KitchenSink-v2-update/kitchensink-v2/node_modules/alloy-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:LyoKICogSFRNTDUgbG9jYWxTdG9yYWdlIHN5bmMgYWRhcHRlcgogKi8KdmFyIF8gPSByZXF1aXJlKCcvYWxsb3kvdW5kZXJzY29yZScpLl87CgpmdW5jdGlvbiBTNCgpIHsKICByZXR1cm4gKCgxICsgTWF0aC5yYW5kb20oKSkgKiAweDEwMDAwIHwgMCkudG9TdHJpbmcoMTYpLnN1YnN0cmluZygxKTsKfQoKZnVuY3Rpb24gZ3VpZCgpIHsKICByZXR1cm4gUzQoKSArIFM0KCkgKyAnLScgKyBTNCgpICsgJy0nICsgUzQoKSArICctJyArIFM0KCkgKyAnLScgKyBTNCgpICsgUzQoKSArIFM0KCk7Cn0KCmZ1bmN0aW9uIEluaXRBZGFwdGVyKCkgewogIGlmICghT1NfTU9CSUxFV0VCKSB7CiAgICB0aHJvdyAnbG9jYWxTdG9yYWdlIHBlcnNpc3RlbmNlIHN1cHBvcnRlZCBvbmx5IHdpdGggTW9iaWxlV2ViLic7CiAgfQp9CgpmdW5jdGlvbiBTeW5jKG1ldGhvZCwgbW9kZWwsIG9wdHMpIHsKICB2YXIgbmFtZSA9IG1vZGVsLmNvbmZpZy5hZGFwdGVyLmNvbGxlY3Rpb25fbmFtZSwKICAgICAgZGF0YSA9IG1vZGVsLmNvbmZpZy5kYXRhLAogICAgICByZXNwID0gbnVsbDsKCiAgZnVuY3Rpb24gc3RvcmVNb2RlbChkYXRhKSB7CiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShuYW1lLCBKU09OLnN0cmluZ2lmeShkYXRhKSk7CiAgfQoKICBzd2l0Y2ggKG1ldGhvZCkgewogICAgY2FzZSAnY3JlYXRlJzoKICAgICAgaWYgKCFtb2RlbC5pZCkgewogICAgICAgIG1vZGVsLmlkID0gZ3VpZCgpOwogICAgICAgIG1vZGVsLnNldChtb2RlbC5pZEF0dHJpYnV0ZSwgbW9kZWwuaWQpOwogICAgICB9CgogICAgICBkYXRhW21vZGVsLmlkXSA9IG1vZGVsOwogICAgICBzdG9yZU1vZGVsKGRhdGEpOwogICAgICByZXNwID0gbW9kZWwudG9KU09OKCk7CiAgICAgIGJyZWFrOwoKICAgIGNhc2UgJ3JlYWQnOgogICAgICB2YXIgc3RvcmUgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShuYW1lKTsKICAgICAgdmFyIHN0b3JlX2RhdGEgPSBzdG9yZSAmJiBKU09OLnBhcnNlKHN0b3JlKSB8fCB7fTsKICAgICAgdmFyIGxlbiA9IDA7CgogICAgICBmb3IgKHZhciBrZXkgaW4gc3RvcmVfZGF0YSkgewogICAgICAgIHZhciBtID0gbmV3IG1vZGVsLmNvbmZpZy5Nb2RlbChzdG9yZV9kYXRhW2tleV0pOwogICAgICAgIG1vZGVsLm1vZGVscy5wdXNoKG0pOwogICAgICAgIGxlbisrOwogICAgICB9CgogICAgICBtb2RlbC5sZW5ndGggPSBsZW47CgogICAgICBpZiAobGVuID09PSAxKSB7CiAgICAgICAgcmVzcCA9IG1vZGVsLm1vZGVsc1swXTsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXNwID0gbW9kZWwubW9kZWxzOwogICAgICB9CgogICAgICBicmVhazsKCiAgICBjYXNlICd1cGRhdGUnOgogICAgICBkYXRhW21vZGVsLmlkXSA9IG1vZGVsOwogICAgICBzdG9yZU1vZGVsKGRhdGEpOwogICAgICByZXNwID0gbW9kZWwudG9KU09OKCk7CiAgICAgIGJyZWFrOwoKICAgIGNhc2UgJ2RlbGV0ZSc6CiAgICAgIGRlbGV0ZSBkYXRhW21vZGVsLmlkXTsKICAgICAgc3RvcmVNb2RlbChkYXRhKTsKICAgICAgcmVzcCA9IG1vZGVsLnRvSlNPTigpOwogICAgICBicmVhazsKICB9IC8vIHByb2Nlc3Mgc3VjY2Vzcy9lcnJvciBoYW5kbGVycywgaWYgcHJlc2VudAoKCiAgaWYgKHJlc3ApIHsKICAgIGlmIChfLmlzRnVuY3Rpb24ob3B0cy5zdWNjZXNzKSkgewogICAgICBvcHRzLnN1Y2Nlc3MocmVzcCk7CiAgICB9CgogICAgaWYgKG1ldGhvZCA9PT0gJ3JlYWQnKSB7CiAgICAgIG1vZGVsLnRyaWdnZXIoJ2ZldGNoJyk7CiAgICB9CiAgfSBlbHNlIHsKICAgIGlmIChfLmlzRnVuY3Rpb24ob3B0cy5lcnJvcikpIHsKICAgICAgb3B0cy5lcnJvcihyZXNwKTsKICAgIH0KICB9Cn0KCm1vZHVsZS5leHBvcnRzLnN5bmMgPSBTeW5jOwoKbW9kdWxlLmV4cG9ydHMuYmVmb3JlTW9kZWxDcmVhdGUgPSBmdW5jdGlvbiAoY29uZmlnKSB7CiAgY29uZmlnID0gY29uZmlnIHx8IHt9OwogIGNvbmZpZy5kYXRhID0ge307IC8vIGZvciBsb2NhbFN0b3JhZ2Ugb3IgY2FzZSB3aGVyZSBlbnRpcmUgY29sbGVjdGlvbiBpcyBuZWVkZWQgdG8gbWFpbnRhaW4gc3RvcmUKCiAgSW5pdEFkYXB0ZXIoKTsKICByZXR1cm4gY29uZmlnOwp9OwoKbW9kdWxlLmV4cG9ydHMuYWZ0ZXJNb2RlbENyZWF0ZSA9IGZ1bmN0aW9uIChNb2RlbCkgewogIE1vZGVsID0gTW9kZWwgfHwge307CiAgTW9kZWwucHJvdG90eXBlLmNvbmZpZy5Nb2RlbCA9IE1vZGVsOyAvLyBuZWVkZWQgZm9yIGZldGNoIG9wZXJhdGlvbnMgdG8gaW5pdGlhbGl6ZSB0aGUgY29sbGVjdGlvbiBmcm9tIHBlcnNpc3RlbnQgc3RvcmUKCiAgcmV0dXJuIE1vZGVsOwp9Ow=="},{"version":3,"sources":["/Users/ssaddique/Axway/KitchenSink-v2-update/kitchensink-v2/node_modules/alloy/Alloy/lib/alloy/sync/localStorage.js"],"names":["_","require","S4","Math","random","toString","substring","guid","InitAdapter","OS_MOBILEWEB","Sync","method","model","opts","name","config","adapter","collection_name","data","resp","storeModel","localStorage","setItem","JSON","stringify","id","set","idAttribute","toJSON","store","getItem","store_data","parse","len","key","m","Model","models","push","length","isFunction","success","trigger","error","module","exports","sync","beforeModelCreate","afterModelCreate","prototype"],"mappings":"AAAA;AACA;AACA;AACA,IAAIA,CAAC,GAAGC,OAAO,CAAC,mBAAD,CAAP,CAA6BD,CAArC;;AAEA,SAASE,EAAT,GAAc;AACb,SAAO,CAAE,CAAC,IAAIC,IAAI,CAACC,MAAL,EAAL,IAAsB,OAAvB,GAAkC,CAAnC,EAAsCC,QAAtC,CAA+C,EAA/C,EAAmDC,SAAnD,CAA6D,CAA7D,CAAP;AACA;;AAED,SAASC,IAAT,GAAgB;AACf,SAAQL,EAAE,KAAKA,EAAE,EAAT,GAAc,GAAd,GAAoBA,EAAE,EAAtB,GAA2B,GAA3B,GAAiCA,EAAE,EAAnC,GAAwC,GAAxC,GAA8CA,EAAE,EAAhD,GAAqD,GAArD,GAA2DA,EAAE,EAA7D,GAAkEA,EAAE,EAApE,GAAyEA,EAAE,EAAnF;AACA;;AAED,SAASM,WAAT,GAAuB;AACtB,MAAI,CAACC,YAAL,EAAmB;AAClB,UAAM,yDAAN;AACA;AACD;;AAED,SAASC,IAAT,CAAcC,MAAd,EAAsBC,KAAtB,EAA6BC,IAA7B,EAAmC;AAClC,MAAIC,IAAI,GAAGF,KAAK,CAACG,MAAN,CAAaC,OAAb,CAAqBC,eAAhC;AAAA,MACCC,IAAI,GAAGN,KAAK,CAACG,MAAN,CAAaG,IADrB;AAAA,MAECC,IAAI,GAAG,IAFR;;AAIA,WAASC,UAAT,CAAoBF,IAApB,EAA0B;AACzBG,IAAAA,YAAY,CAACC,OAAb,CAAqBR,IAArB,EAA2BS,IAAI,CAACC,SAAL,CAAeN,IAAf,CAA3B;AACA;;AAED,UAAQP,MAAR;AAEC,SAAK,QAAL;AACC,UAAI,CAACC,KAAK,CAACa,EAAX,EAAe;AACdb,QAAAA,KAAK,CAACa,EAAN,GAAWlB,IAAI,EAAf;AACAK,QAAAA,KAAK,CAACc,GAAN,CAAUd,KAAK,CAACe,WAAhB,EAA6Bf,KAAK,CAACa,EAAnC;AACA;;AACDP,MAAAA,IAAI,CAACN,KAAK,CAACa,EAAP,CAAJ,GAAiBb,KAAjB;AACAQ,MAAAA,UAAU,CAACF,IAAD,CAAV;AACAC,MAAAA,IAAI,GAAGP,KAAK,CAACgB,MAAN,EAAP;AACA;;AAED,SAAK,MAAL;AACC,UAAIC,KAAK,GAAGR,YAAY,CAACS,OAAb,CAAqBhB,IAArB,CAAZ;AACA,UAAIiB,UAAU,GAAIF,KAAK,IAAIN,IAAI,CAACS,KAAL,CAAWH,KAAX,CAAV,IAAgC,EAAjD;AAEA,UAAII,GAAG,GAAG,CAAV;;AACA,WAAK,IAAIC,GAAT,IAAgBH,UAAhB,EAA4B;AAC3B,YAAII,CAAC,GAAG,IAAIvB,KAAK,CAACG,MAAN,CAAaqB,KAAjB,CAAuBL,UAAU,CAACG,GAAD,CAAjC,CAAR;AACAtB,QAAAA,KAAK,CAACyB,MAAN,CAAaC,IAAb,CAAkBH,CAAlB;AACAF,QAAAA,GAAG;AACH;;AAEDrB,MAAAA,KAAK,CAAC2B,MAAN,GAAeN,GAAf;;AACA,UAAIA,GAAG,KAAK,CAAZ,EAAe;AACdd,QAAAA,IAAI,GAAGP,KAAK,CAACyB,MAAN,CAAa,CAAb,CAAP;AACA,OAFD,MAEO;AACNlB,QAAAA,IAAI,GAAGP,KAAK,CAACyB,MAAb;AACA;;AACD;;AAED,SAAK,QAAL;AACCnB,MAAAA,IAAI,CAACN,KAAK,CAACa,EAAP,CAAJ,GAAiBb,KAAjB;AACAQ,MAAAA,UAAU,CAACF,IAAD,CAAV;AACAC,MAAAA,IAAI,GAAGP,KAAK,CAACgB,MAAN,EAAP;AACA;;AAED,SAAK,QAAL;AACC,aAAOV,IAAI,CAACN,KAAK,CAACa,EAAP,CAAX;AACAL,MAAAA,UAAU,CAACF,IAAD,CAAV;AACAC,MAAAA,IAAI,GAAGP,KAAK,CAACgB,MAAN,EAAP;AACA;AAzCF,GATkC,CAqDlC;;;AACA,MAAIT,IAAJ,EAAU;AACT,QAAInB,CAAC,CAACwC,UAAF,CAAa3B,IAAI,CAAC4B,OAAlB,CAAJ,EAAgC;AAAE5B,MAAAA,IAAI,CAAC4B,OAAL,CAAatB,IAAb;AAAqB;;AACvD,QAAIR,MAAM,KAAK,MAAf,EAAuB;AAAEC,MAAAA,KAAK,CAAC8B,OAAN,CAAc,OAAd;AAAyB;AAClD,GAHD,MAGO;AACN,QAAI1C,CAAC,CAACwC,UAAF,CAAa3B,IAAI,CAAC8B,KAAlB,CAAJ,EAA8B;AAAE9B,MAAAA,IAAI,CAAC8B,KAAL,CAAWxB,IAAX;AAAmB;AACnD;AACD;;AAEDyB,MAAM,CAACC,OAAP,CAAeC,IAAf,GAAsBpC,IAAtB;;AAEAkC,MAAM,CAACC,OAAP,CAAeE,iBAAf,GAAmC,UAAShC,MAAT,EAAiB;AACnDA,EAAAA,MAAM,GAAGA,MAAM,IAAI,EAAnB;AAEAA,EAAAA,MAAM,CAACG,IAAP,GAAc,EAAd,CAHmD,CAGjC;;AAElBV,EAAAA,WAAW;AAEX,SAAOO,MAAP;AACA,CARD;;AAUA6B,MAAM,CAACC,OAAP,CAAeG,gBAAf,GAAkC,UAASZ,KAAT,EAAgB;AACjDA,EAAAA,KAAK,GAAGA,KAAK,IAAI,EAAjB;AAEAA,EAAAA,KAAK,CAACa,SAAN,CAAgBlC,MAAhB,CAAuBqB,KAAvB,GAA+BA,KAA/B,CAHiD,CAGX;;AAEtC,SAAOA,KAAP;AACA,CAND","sourcesContent":["/*\n * HTML5 localStorage sync adapter\n */\nvar _ = require('/alloy/underscore')._;\n\nfunction S4() {\n\treturn (((1 + Math.random()) * 0x10000) | 0).toString(16).substring(1);\n}\n\nfunction guid() {\n\treturn (S4() + S4() + '-' + S4() + '-' + S4() + '-' + S4() + '-' + S4() + S4() + S4());\n}\n\nfunction InitAdapter() {\n\tif (!OS_MOBILEWEB) {\n\t\tthrow 'localStorage persistence supported only with MobileWeb.';\n\t}\n}\n\nfunction Sync(method, model, opts) {\n\tvar name = model.config.adapter.collection_name,\n\t\tdata = model.config.data,\n\t\tresp = null;\n\n\tfunction storeModel(data) {\n\t\tlocalStorage.setItem(name, JSON.stringify(data));\n\t}\n\n\tswitch (method) {\n\n\t\tcase 'create':\n\t\t\tif (!model.id) {\n\t\t\t\tmodel.id = guid();\n\t\t\t\tmodel.set(model.idAttribute, model.id);\n\t\t\t}\n\t\t\tdata[model.id] = model;\n\t\t\tstoreModel(data);\n\t\t\tresp = model.toJSON();\n\t\t\tbreak;\n\n\t\tcase 'read':\n\t\t\tvar store = localStorage.getItem(name);\n\t\t\tvar store_data = (store && JSON.parse(store)) || {};\n\n\t\t\tvar len = 0;\n\t\t\tfor (var key in store_data) {\n\t\t\t\tvar m = new model.config.Model(store_data[key]);\n\t\t\t\tmodel.models.push(m);\n\t\t\t\tlen++;\n\t\t\t}\n\n\t\t\tmodel.length = len;\n\t\t\tif (len === 1) {\n\t\t\t\tresp = model.models[0];\n\t\t\t} else {\n\t\t\t\tresp = model.models;\n\t\t\t}\n\t\t\tbreak;\n\n\t\tcase 'update':\n\t\t\tdata[model.id] = model;\n\t\t\tstoreModel(data);\n\t\t\tresp = model.toJSON();\n\t\t\tbreak;\n\n\t\tcase 'delete':\n\t\t\tdelete data[model.id];\n\t\t\tstoreModel(data);\n\t\t\tresp = model.toJSON();\n\t\t\tbreak;\n\t}\n\n\t// process success/error handlers, if present\n\tif (resp) {\n\t\tif (_.isFunction(opts.success)) { opts.success(resp); }\n\t\tif (method === 'read') { model.trigger('fetch'); }\n\t} else {\n\t\tif (_.isFunction(opts.error)) { opts.error(resp); }\n\t}\n}\n\nmodule.exports.sync = Sync;\n\nmodule.exports.beforeModelCreate = function(config) {\n\tconfig = config || {};\n\n\tconfig.data = {}; // for localStorage or case where entire collection is needed to maintain store\n\n\tInitAdapter();\n\n\treturn config;\n};\n\nmodule.exports.afterModelCreate = function(Model) {\n\tModel = Model || {};\n\n\tModel.prototype.config.Model = Model; // needed for fetch operations to initialize the collection from persistent store\n\n\treturn Model;\n};\n"]}]}